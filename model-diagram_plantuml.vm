## -----------------------------------------------------------------------
## This template generates a database diagram 
## with the tables and their relationships
## -----------------------------------------------------------------------
@startuml

## --- Model description note
note as TelosysDiagramTitleNote
  <b>$model.name</b> model
  diagram generated by <b>Telosys</b>
  $now.date ( $now.time )
end note

## --- Macro for attribute documentation
#macro(attribdoc, $attrib)
#set($list = [])
#if ($attribute.isKeyElement()    )#set( $z = $list.add("ID") )#end
#if ($attribute.isFK()            )#set( $z = $list.add("FK") )#end
#if ($attribute.isNotNull()       )#set( $z = $list.add("NN") )#end
#if ($attribute.isUnique()        )#set( $z = $list.add("U")  )#end
#if ($attribute.isGeneratedValue())#set( $z = $list.add("G")  )#end
#set($r = $fn.join($list, " ") )
#if($r != "")#set($comment = "($r)")#else#set($comment = "")#end
## For target language type you can use $attribute.type instead of $attribute.neutralType 
  $attribute.name#if($attribute.isKeyElement() ) ðŸ†”#end : $attribute.neutralType  $comment
#end
## --- Macro for link documentation
#macro(linkdoc, $link)
#if( $link.isCardinalityToMany() )#set($prefix="list of ")#else#set($prefix="")#end
    â†’ $link.fieldName : ${prefix}$link.targetEntityName ($link.cardinality)
#end
## --- Entities 
#foreach( $entity in $selectedEntities )
entity $entity.name #if( $entity.isJoinEntity() ) << (J,cornsilk) >> #end {
#foreach( $attribute in $entity.keyAttributes )
#attribdoc($attribute)
#end
  ....
#foreach( $attribute in $entity.nonKeyAttributes )
#attribdoc($attribute)
#end
  --
#foreach( $link in $entity.links )
##  $link.fieldName : $link.fieldType
#linkdoc($link)
#end
}
#end

## --- Links between tables (Model links != Database FK)
#foreach( $entity in $selectedEntities )
#foreach( $link in $entity.links )
#if ( $link.isCardinalityManyToOne() )
$entity.name }o--|| $link.targetEntity.name
#elseif ( $link.isCardinalityOneToOne() )
$entity.name ||--|| $link.targetEntity.name
#elseif ( $link.isCardinalityOneToMany() )
$entity.name ||--o{ $link.targetEntity.name
#elseif ( $link.isCardinalityManyToMany() )
$entity.name }o--o{ $link.targetEntity.name #if($link.hasJoinEntity()) : "($link.joinEntityName)" ${NEWLINE}#end
#end
#end
#end

@enduml
